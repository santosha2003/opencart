!function(a){"use strict";function b(a,b){this.el=b,this.init(a)}var c="pinto";b.prototype={defaults:{itemSelector:"> div",itemSkipClass:"pinto-skip",itemWidth:220,gapX:10,gapY:10,align:"left",fitWidth:!0,autoResize:!0,resizeDelay:50,onItemLayout:function(a,b,c){}},config:null,resizeEvent:null,resizeTimer:null,el:null,init:function(a){this.destroyResize(),this.config=a,this.build(),this.layout()},destroyResize:function(){this.resizeEvent&&(this.resizeEvent.unbind(),this.resizeEvent=null),clearTimeout(this.resizeTimer)},build:function(){0!=this.el.length&&("relative"!=this.el.css("position")&&this.el.css("position","relative"),this.config.autoResize&&(this.resizeEvent=a(window).on("resize",a.proxy(this.resize,this)),this.el.on("remove",this.resizeEvent.unbind)))},layout:function(){if(0!=this.el.length&&this.el.is(":visible")){for(var b=this,c=this.el.find(this.config.itemSelector),d=this.el.innerWidth(),e=this.config.itemWidth,f=parseInt(this.config.gapX||0),g=parseInt(this.config.gapY||0),h=0,i=0;d>h&&(h+=e,d>=h);)i++,h+=f;i=Math.max(i,1);for(var j=[],k=[],l=i;l--;)j.push(0),k.push(0);h=0;var m=(i-1)*f;this.config.fitWidth?e+=Math.floor(.5+(d-m-i*e)/i):"center"===this.config.align?h+=Math.floor(.5+(d-m-i*e)>>1):"right"===this.config.align&&(h+=Math.floor(.5+(d-m-i*e))),c.each(function(c,d){var i=a(d),l=b.getSmallestIndex(k);i.is(":visible")&&!i.hasClass(b.itemSkipClass)&&(i.css({position:"absolute",top:k[l]+"px",left:(e+f)*l+h+"px",width:e}),k[l]+=i.outerHeight()+g,"function"==typeof b.config.onItemLayout&&b.config.onItemLayout.call(b,i,l,j[l]),j[l]++)});var n=0;for(l=i;l--;)k[l]>n&&(n=k[l]);this.el.css({height:n})}},resize:function(){clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout(a.proxy(this.layout,this),this.config.resizeDelay)},destroy:function(){this.destroyResize(),this.el.removeData(c);var b=this.el.find(this.config.itemSelector);b.each(function(){var b=a(this);b.css({position:"",top:"",left:"",width:""})}),this.el.css({position:"",height:""})},getSmallestIndex:function(a){for(var b=0,c=1,d=a.length;d>c;c++)a[c]<a[b]&&(b=c);return b}},a.fn.pinto=function(d,e){var f=this.data(c);if("layout"==d){if(!f)throw Error("Calling 'layout' method on not initialized instance is forbidden");return f.layout()}if("destroy"==d){if(!f)throw Error("Calling 'destroy' method on not initialized instance is forbidden");return f.destroy()}return this.each(function(){var e=a(this),f=e.data(c),g=a.isPlainObject(d)?d:{};if(f){var h=a.extend({},f.config,g);f.init(h)}else{var h=a.extend({},b.prototype.defaults,g);f=new b(h,e),e.data(c,f)}})}}(window.jQuery);